<!DOCTYPE html>
<html>
<head>
  <style>
    li {
      display: none;
      float: left;
      list-style: none;
    }
    button {
      float: left;
    }
    .sortOrderDiv {
      clear: both;
    }
  </style>
</head>
<body>
<!--
1. Use HTML, CSS and JavaScript to build an image slideshow
2. Do not use any third party slideshow, image or photo gallery plugins
3. You may use a framework like jQuery or AngularJS
4. Use deferred image loading
   - load only two images on page load (the current slide and the next slide)
   - load two images at a time on next button click (the next slide image and the slide image after next)
5. User event tracking
   - on each previous or next button click, call single pixel image below
   - http://www.healthline.com/images/clear.gif
6. Use Healthline API to get slideshow data:
   - slideshow data URL:
   - https://api2.healthline.com/api/service/2.0/slideshow/content?partnerId=7eef498c-f7fa-4f7c-81fd-b1cc53ac7ebc&contentid=17103&includeLang=en
   - use the following data items:
   - Page title
   - summary
   - individual slide data (slides array):
     - title
     - image (image object)
     - slide text content (body)
7. Sort order filter:
   - create an interface to allow the user to change the sort order of the slides
   - two options: default, alpha
   - sort by alpha on slide title
   - default order is from JSON data
8. You may use Healthline Slideshow as inspiration for UI/UX (NOT a requirement)
   - http://www.healthline.com/health-slideshow/7-ways-lessen-your-back-pain
9. Update the HTML as needed
10. Display one image at a time
11. Your submitted work must be a functional stand-alone working HTML page
-->


<!-- example of HTML structure -->
<div class="slideshow">
  <button id="previous" onclick="callSinglePixelImg()" type="button" name="previous">previous</button>
  <ul class="slides">
    <li class="current">
      <!-- slide markup goes here -->
    </li>
    <li class="next">
      <!-- slide markup goes here -->
    </li>
    <!-- <li>
      etc
    </li> -->
  </ul>
  <button id="next" onclick="callSinglePixelImg()" type="button" name="next">next</button>

  <!--<button id="default" type="button" name="default">default</button>
  <button id="alpha" type="button" name="alpha">alpha</button>-->
  <div class="sortOrderDiv">Sort order filter
    <select id="sortOrder">
      <option slelected="selected">default</option>
      <option>alpha</option>
    </select>
  </div>


</div>

</body>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

<!-- <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script> -->
<script>
  var i = 0;
  var alphaSorted = false;
  var slides = [];
  var slidesOrg;
  var renderOnce = function(){
    // $('li').first().show('slow', function showNext(){
    //   $(this).next('li').show("slow");
    // });
    $('li').first().show();
  };

  $.ajax({
    url: 'https://api2.healthline.com/api/service/2.0/slideshow/content?partnerId=7eef498c-f7fa-4f7c-81fd-b1cc53ac7ebc&contentid=17103&includeLang=en',
    type: 'GET',
    dataType: 'jsonp',
    xhrFields: {
      withCrendentials: true
    },
    success: function (data){
      slides = data.data[0].slides;
      console.log('data', data);
      var url = "http://www.healthline.com/";
      var imageUrlCur = slides[i].image.imageUrl;
      var imageUrlNext = slides[i + 1].image.imageUrl;
      // $('.current').prepend('<img src="' + url + imageUrlCur + '">').css('display', 'none');
      $('.current').prepend('<img src="' + url + imageUrlCur + '">');
      // $('.next').prepend('<img src="' + url + imageUrlNext + '">').css('display', 'none');
      $('.next').prepend('<img src="' + url + imageUrlNext + '">');
      // $('li').first().show('fast', function showNext(){
      //   $(this).next('li').show("fast");
      // });
      renderOnce();
    },
    error: function (data){
      console.log('failed');
    } 
  });
  
  $('#next').on('click', function(){
    console.log('i', i);
    if(i < 7){
      i++;
      var url = "http://www.healthline.com/";
      console.log('i+1', i + 1);
      var imageUrlNext = slides[i + 1].image.imageUrl;
      $('li').hide();
      $('.current img').replaceWith($('.next img'));
      $('.next').prepend('<img src="' + url + imageUrlNext + '">');
      renderOnce();
    }else if(i === 7){
      $('li').hide();
      $('.next').show();
    }
  });

  $('#previous').on('click', function(){
    if(i === 7){
      i--;
      $('li').hide();
      $('li').first().show();
    }else if(i > 0){
      i--;
      var url = "http://www.healthline.com/";
      var imageUrlNext = slides[i].image.imageUrl;
      $('li').hide();
      $('.next img').replaceWith($('.current img'));
      $('.current').prepend('<img src="' + url + imageUrlNext + '">');
      renderOnce();
    }
  });

  $('#default').on('click', function(){
    if(alphaSorted){
      alphaSorted = !alphaSorted;
      slides = slidesOrg;
    }
  });

  $('#alpha').on('click', function(){
    if(!alphaSorted){
      alphaSorted = !alphaSorted;
      slidesOrg = slidesOrg || slides.slice(0);
      slides.sort(function(a, b){
        if(a.title > b.title){
          return 1;
        }
        if(a.title < b.title){
          return -1;
        }
        return 0;
      });
    }
  });
  
  $('#sortOrder').change(function(){
    var newVal = $(this).val();
    console.log('newVal', newVal);
  });
  
  var callSinglePixelImg = function(){
    var url = 'http://www.healthline.com/images/clear.gif?' + new Date().getTime();
    $('body').append("<img class='singlePixel' src='"+ url + "'>");
    $('.singlePixel').remove();
  };


</script>

</html>
